# Guia de Instala√ß√£o e Compila√ß√£o - Windows 11

Este guia fornece instru√ß√µes detalhadas para compilar e executar o **FingerprintEnhancer** no Windows 11.

## üìã √çndice

- [Pr√©-requisitos](#pr√©-requisitos)
- [Instala√ß√£o R√°pida](#instala√ß√£o-r√°pida)
- [Instala√ß√£o Manual](#instala√ß√£o-manual)
- [Compila√ß√£o](#compila√ß√£o)
- [Solu√ß√£o de Problemas](#solu√ß√£o-de-problemas)
- [Perguntas Frequentes](#perguntas-frequentes)

---

## üéØ Pr√©-requisitos

Para compilar o FingerprintEnhancer no Windows 11, voc√™ precisa de:

### Ferramentas Essenciais

1. **CMake 3.16+** - Sistema de build
2. **Qt6** - Framework de interface gr√°fica
3. **OpenCV 4.x** - Biblioteca de processamento de imagem
4. **Compilador C++17**:
   - **Op√ß√£o 1**: MinGW-w64 (recomendado para c√≥digo aberto)
   - **Op√ß√£o 2**: Visual Studio 2022 Community (gratuito)

---

## ‚ö° Instala√ß√£o R√°pida

### Usando Scripts Automatizados

Execute estes comandos no **PowerShell** (como Administrador):

```powershell
# 1. Verificar depend√™ncias instaladas
.\scripts\install_deps_win.bat check

# 2. Instalar ferramentas b√°sicas (CMake, MinGW)
.\scripts\install_deps_win.bat install

# 3. Compilar o projeto
.\scripts\build_win.bat debug

# 4. Executar a aplica√ß√£o
.\scripts\run_win.bat debug
```

> **Nota**: Qt6 e OpenCV precisam ser instalados manualmente (veja se√ß√£o abaixo).

---

## üîß Instala√ß√£o Manual

### 1. Instalar Chocolatey (Gerenciador de Pacotes)

Execute no **PowerShell (Administrador)**:

```powershell
Set-ExecutionPolicy Bypass -Scope Process -Force
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
```

Feche e reabra o PowerShell ap√≥s a instala√ß√£o.

### 2. Instalar CMake

```powershell
choco install -y cmake
```

Ou baixe manualmente: https://cmake.org/download/

### 3. Instalar Compilador

#### Op√ß√£o A: MinGW-w64 (Recomendado)

```powershell
choco install -y mingw
```

Ou baixe de: https://www.mingw-w64.org/

**Adicione ao PATH**:
- Caminho t√≠pico: `C:\ProgramData\mingw64\mingw64\bin`
- Painel de Controle ‚Üí Sistema ‚Üí Vari√°veis de Ambiente ‚Üí PATH

#### Op√ß√£o B: Visual Studio 2022 Community

Baixe e instale: https://visualstudio.microsoft.com/downloads/

Durante a instala√ß√£o, selecione:
- ‚úÖ **Desenvolvimento para Desktop com C++**
- ‚úÖ **Ferramentas CMake para Windows**

### 4. Instalar Qt6

1. Baixe o instalador online: https://www.qt.io/download-qt-installer
2. Execute o instalador
3. Fa√ßa login (crie conta gratuita se necess√°rio)
4. Selecione componentes:
   - ‚úÖ **Qt 6.9.x** (ou vers√£o mais recente)
   - ‚úÖ **MinGW 64-bit** (se usar MinGW como compilador)
   - ‚úÖ **MSVC 2022 64-bit** (se usar Visual Studio)
   - ‚úÖ **Qt Creator** (opcional, IDE)

5. Caminho de instala√ß√£o padr√£o: `C:\Qt\6.9.3`

### 5. Instalar OpenCV

#### Op√ß√£o A: Bin√°rios Pr√©-compilados (R√°pido)

1. Baixe: https://opencv.org/releases/
2. Extraia para `C:\opencv`
3. Estrutura esperada:
   ```
   C:\opencv\
   ‚îú‚îÄ‚îÄ build\
   ‚îÇ   ‚îî‚îÄ‚îÄ x64\
   ‚îÇ       ‚îú‚îÄ‚îÄ vc16\      (bin√°rios MSVC)
   ‚îÇ       ‚îî‚îÄ‚îÄ mingw\     (bin√°rios MinGW, se dispon√≠vel)
   ```

> ‚ö†Ô∏è **IMPORTANTE**: Os bin√°rios oficiais do OpenCV s√£o compilados com MSVC. Se usar MinGW, voc√™ precisar√° compilar o OpenCV manualmente (veja Op√ß√£o B).

#### Op√ß√£o B: Compilar OpenCV com MinGW (Para compatibilidade)

```powershell
# Clone o reposit√≥rio
git clone https://github.com/opencv/opencv.git C:\opencv-src
cd C:\opencv-src

# Criar diret√≥rio de build
mkdir build-mingw
cd build-mingw

# Configurar com CMake
cmake -G "MinGW Makefiles" ^
  -DCMAKE_BUILD_TYPE=Release ^
  -DCMAKE_INSTALL_PREFIX=C:\opencv ^
  -DBUILD_EXAMPLES=OFF ^
  -DBUILD_TESTS=OFF ^
  -DBUILD_PERF_TESTS=OFF ^
  ..

# Compilar (pode demorar 30-60 minutos)
cmake --build . --parallel 4

# Instalar
cmake --install .
```

---

## üî® Compila√ß√£o

### Usando Scripts Automatizados (Recomendado)

```powershell
# Verificar se todas as depend√™ncias est√£o instaladas
.\scripts\install_deps_win.bat check

# Compilar vers√£o Debug (para desenvolvimento)
.\scripts\build_win.bat debug

# Compilar vers√£o Release (otimizada)
.\scripts\build_win.bat release

# Limpar builds
.\scripts\build_win.bat clean

# Recompilar do zero
.\scripts\build_win.bat rebuild
```

### Compila√ß√£o Manual com CMake

Se os caminhos padr√£o n√£o funcionarem, configure manualmente:

```powershell
# Definir caminhos das depend√™ncias
$env:QT_DIR = "C:\Qt\6.9.3"
$env:OPENCV_DIR = "C:\opencv"
$env:GENERATOR = "MinGW Makefiles"  # ou "Visual Studio 17 2022"

# Configurar
cmake -B build -S . -G "MinGW Makefiles" ^
  -DCMAKE_PREFIX_PATH="C:/Qt/6.9.3/mingw_64/lib/cmake;C:/opencv/build" ^
  -DCMAKE_BUILD_TYPE=Debug

# Compilar
cmake --build build --config Debug --parallel 4
```

### Deploy de DLLs

Ap√≥s compilar, copie as DLLs necess√°rias:

```powershell
# Copiar DLLs automaticamente
.\scripts\deploy_win.bat debug

# Ou para release
.\scripts\deploy_win.bat release
```

Este script copia:
- DLLs do Qt6 (Qt6Core, Qt6Gui, Qt6Widgets, etc.)
- Plugins do Qt6 (platforms, imageformats, etc.)
- DLLs do OpenCV
- DLLs do MinGW runtime (se aplic√°vel)

---

## ‚ñ∂Ô∏è Executar a Aplica√ß√£o

### Usando o Script

```powershell
# Executar vers√£o Debug
.\scripts\run_win.bat debug

# Executar vers√£o Release
.\scripts\run_win.bat release
```

### Executar Manualmente

```powershell
# Debug
.\build\bin\FingerprintEnhancer.exe

# Release
.\build-release\bin\FingerprintEnhancer.exe
```

---

## üîç Solu√ß√£o de Problemas

### Problema: "CMake n√£o encontrado"

**Solu√ß√£o**:
```powershell
# Verificar instala√ß√£o
cmake --version

# Se n√£o funcionar, adicionar ao PATH
$env:PATH += ";C:\Program Files\CMake\bin"
```

### Problema: "Qt6 n√£o encontrado"

**Erro**:
```
CMake Error: Could not find a package configuration file provided by "Qt6"
```

**Solu√ß√£o**:
```powershell
# Definir vari√°vel de ambiente
$env:QT_DIR = "C:\Qt\6.9.3"

# Ou especificar diretamente no CMake
cmake -DCMAKE_PREFIX_PATH="C:/Qt/6.9.3/mingw_64/lib/cmake" ...
```

### Problema: "OpenCV n√£o encontrado"

**Erro**:
```
CMake Error: Could not find a package configuration file provided by "OpenCV"
```

**Solu√ß√£o**:
```powershell
# Verificar se OpenCV est√° instalado
dir C:\opencv\build

# Definir vari√°vel
$env:OPENCV_DIR = "C:\opencv"
```

### Problema: "DLL n√£o encontrada ao executar"

**Erro**:
```
The code execution cannot proceed because Qt6Core.dll was not found
```

**Solu√ß√£o**:
```powershell
# Executar script de deploy
.\scripts\deploy_win.bat debug

# Verificar se DLLs foram copiadas
dir build\bin\*.dll
```

### Problema: Incompatibilidade MinGW vs MSVC

**Erro durante linking**:
```
undefined reference to ...
```

**Causa**: OpenCV compilado com MSVC, mas tentando usar MinGW (ou vice-versa).

**Solu√ß√£o**:

**Op√ß√£o 1** - Usar MSVC para tudo:
```powershell
# Abrir "Developer Command Prompt for VS 2022"
$env:GENERATOR = "Visual Studio 17 2022"
.\scripts\build_win.bat debug
```

**Op√ß√£o 2** - Recompilar OpenCV com MinGW (veja se√ß√£o [Instalar OpenCV - Op√ß√£o B](#op√ß√£o-b-compilar-opencv-com-mingw-para-compatibilidade))

### Problema: "Generator mismatch"

**Erro**:
```
Error: generator : MinGW Makefiles
Does not match the generator used previously: NMake Makefiles
```

**Solu√ß√£o**:
```powershell
# Limpar cache do CMake
.\scripts\build_win.bat clean
# Recompilar
.\scripts\build_win.bat debug
```

### Problema: Faltam plugins do Qt

**Erro ao executar**:
```
This application failed to start because no Qt platform plugin could be initialized
```

**Solu√ß√£o**:
```powershell
# Verificar se plugin existe
dir build\bin\platforms\qwindows.dll

# Se n√£o existir, executar deploy novamente
.\scripts\deploy_win.bat debug
```

---

## ‚ùì Perguntas Frequentes

### Q: Qual compilador devo usar: MinGW ou MSVC?

**A**: Recomendamos **MinGW-w64** para manter compatibilidade com c√≥digo aberto. No entanto, se voc√™ j√° tem Visual Studio instalado e baixou OpenCV pr√©-compilado, **MSVC** √© mais f√°cil.

### Q: Preciso recompilar o OpenCV?

**A**: Depende:
- **MSVC**: N√£o, use os bin√°rios pr√©-compilados do site oficial
- **MinGW**: Sim, compile manualmente para garantir compatibilidade

### Q: O projeto compila mas n√£o executa

**A**: Execute o script de deploy:
```powershell
.\scripts\deploy_win.bat debug
```

### Q: Posso usar Qt5 ao inv√©s de Qt6?

**A**: N√£o, o projeto requer Qt6. Modificar para Qt5 exigiria mudan√ßas significativas no c√≥digo.

### Q: Como atualizar as depend√™ncias?

**A**:
```powershell
# Atualizar via Chocolatey
choco upgrade cmake mingw

# Qt e OpenCV: baixar novas vers√µes manualmente
```

### Q: Posso compilar vers√£o de 32 bits?

**A**: O projeto √© projetado para 64 bits. Compilar para 32 bits requer modifica√ß√µes no CMakeLists.txt e depend√™ncias x86.

### Q: Como criar um instalador?

**A**: Use CPack (inclu√≠do no CMakeLists.txt):
```powershell
# Ap√≥s compilar release
cd build-release
cpack -G NSIS
```

Isso cria um instalador `.exe` usando NSIS.

---

## üì¶ Estrutura de Diret√≥rios Ap√≥s Build

```
FingerprintEnhancer/
‚îú‚îÄ‚îÄ build/                          # Build Debug
‚îÇ   ‚îú‚îÄ‚îÄ bin/                        # Execut√°vel e DLLs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FingerprintEnhancer.exe
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Qt6Core.dll
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Qt6Gui.dll
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ libopencv_core*.dll
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ platforms/              # Plugins Qt
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ lib/                        # Bibliotecas est√°ticas
‚îú‚îÄ‚îÄ build-release/                  # Build Release
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ install_deps_win.bat        # Verificar/instalar depend√™ncias
‚îÇ   ‚îú‚îÄ‚îÄ build_win.bat               # Compilar projeto
‚îÇ   ‚îú‚îÄ‚îÄ deploy_win.bat              # Copiar DLLs
‚îÇ   ‚îî‚îÄ‚îÄ run_win.bat                 # Executar aplica√ß√£o
‚îî‚îÄ‚îÄ src/                            # C√≥digo-fonte
```

---

## üéì Comandos de Refer√™ncia R√°pida

```powershell
# ===== SETUP INICIAL =====
.\scripts\install_deps_win.bat check    # Verificar depend√™ncias
.\scripts\install_deps_win.bat install  # Instalar via Chocolatey

# ===== COMPILA√á√ÉO =====
.\scripts\build_win.bat debug           # Compilar Debug
.\scripts\build_win.bat release         # Compilar Release
.\scripts\build_win.bat clean           # Limpar
.\scripts\build_win.bat rebuild         # Recompilar

# ===== DEPLOYMENT =====
.\scripts\deploy_win.bat debug          # Deploy DLLs (Debug)
.\scripts\deploy_win.bat release        # Deploy DLLs (Release)

# ===== EXECU√á√ÉO =====
.\scripts\run_win.bat debug             # Executar Debug
.\scripts\run_win.bat release           # Executar Release

# ===== VARI√ÅVEIS DE AMBIENTE =====
$env:QT_DIR = "C:\Qt\6.9.3"
$env:OPENCV_DIR = "C:\opencv"
$env:GENERATOR = "MinGW Makefiles"
```

---

## üìû Suporte

Se voc√™ encontrar problemas n√£o listados aqui:

1. Verifique o arquivo `build_log.txt` no diret√≥rio raiz
2. Abra uma issue no GitHub: [FingerprintEnhancer Issues](https://github.com/seu-usuario/FingerprintEnhancer/issues)
3. Email: adelinocpp@yahoo.com

---

## üìù Changelog

### Vers√£o 1.0.0
- ‚úÖ Suporte completo para Windows 11
- ‚úÖ Scripts automatizados de build e deploy
- ‚úÖ Compatibilidade com MinGW e MSVC
- ‚úÖ Auto-detec√ß√£o de depend√™ncias

---

**FingerprintEnhancer** - An√°lise forense de impress√µes digitais de c√≥digo aberto para Windows 11.
